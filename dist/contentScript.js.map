{"version":3,"file":"contentScript.js","mappings":";;;;;;AAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA,CAAC","sources":["webpack://hockeynation/./src/contentScript.ts"],"sourcesContent":["\"use strict\";\nconst calculateOVR = (stats) => {\n    const statsValues = Object.keys(stats).map((key) => stats[key]);\n    const sum = statsValues.reduce((acc, stat) => acc + stat.rating, 0);\n    const avg = sum / statsValues.length;\n    let excess = 0;\n    for (const stat of statsValues) {\n        if (stat.rating > avg) {\n            excess += stat.rating - avg;\n        }\n    }\n    const correctedSum = sum + excess;\n    const correctedAverage = correctedSum / statsValues.length;\n    const ovr = Math.round(correctedAverage * 10);\n    return ovr;\n};\nconst parseStatsTable = () => {\n    const puck = document.querySelector(\"svg.fa-hockey-puck\");\n    if (!puck) {\n        return false;\n    }\n    let ancestor = puck.parentElement;\n    while (ancestor && !ancestor.matches(\"table[data-v-a81c915e]\")) {\n        ancestor = ancestor.parentElement;\n    }\n    const statsTable = ancestor;\n    if (!statsTable) {\n        return false;\n    }\n    const divs = document.querySelectorAll(\"div.card-header\");\n    const ovrElement = document.querySelector(\"div.polygon.select-none text\");\n    const baseOVR = ovrElement ? ovrElement.textContent : null;\n    const updateOVR = (ovr) => {\n        var _a;\n        const ovrElement = document.querySelector(\"div.polygon.select-none text\");\n        if (ovrElement) {\n            if (scoutPlayer && baseOVR) {\n                ovrElement.textContent = baseOVR.toString();\n            }\n            else {\n                ovrElement.textContent = ovr.toString();\n            }\n            const polygonElement = (_a = ovrElement.parentElement) === null || _a === void 0 ? void 0 : _a.querySelector(\"polygon\");\n            if (polygonElement) {\n                let fillColor = \"\";\n                if (ovr <= 39) {\n                    fillColor = \"#f56565\";\n                }\n                else if (ovr >= 40 && ovr <= 54) {\n                    fillColor = \"#ed8936\";\n                }\n                else if (ovr >= 55 && ovr <= 69) {\n                    fillColor = \"#1995AD\";\n                }\n                else if (ovr >= 70 && ovr <= 79) {\n                    fillColor = \"#10b981\";\n                }\n                else if (ovr >= 80) {\n                    fillColor = \"#383839\";\n                }\n                polygonElement.setAttribute(\"fill\", fillColor);\n            }\n        }\n    };\n    const updateHockeyPucks = (option) => {\n        statsRows.forEach((row) => {\n            var _a, _b;\n            const statName = ((_b = (_a = row.cells[0]) === null || _a === void 0 ? void 0 : _a.textContent) === null || _b === void 0 ? void 0 : _b.trim()) || \"\";\n            const pucksCell = row.cells[1];\n            const pucks = pucksCell.querySelectorAll(\"svg.fa-hockey-puck\");\n            const ratingCell = row.cells[2];\n            const ratingSpan = ratingCell === null || ratingCell === void 0 ? void 0 : ratingCell.querySelector(\"span\");\n            const stat = stats[statName];\n            if (stat) {\n                let rating = stat.rating;\n                if (option === \"Min\") {\n                    rating = minStats[statName].rating;\n                }\n                else if (option === \"Max\") {\n                    rating = maxStats[statName].rating;\n                }\n                pucks.forEach((puck, index) => {\n                    puck.classList.remove(\"text-blue-400\");\n                    if (index < rating) {\n                        puck.classList.remove(\"text-gray-300\");\n                        if (index >= stat.rating) {\n                            puck.classList.add(\"text-blue-400\");\n                        }\n                    }\n                    else {\n                        puck.classList.add(\"text-gray-300\");\n                    }\n                    if (index === rating - 1 && stat.hasRedPuck) {\n                        puck.classList.add(\"max-level\");\n                    }\n                    else {\n                        puck.classList.remove(\"max-level\");\n                    }\n                });\n                // update the rating value in the span element\n                if (ratingSpan) {\n                    ratingSpan.textContent = `(${rating})`;\n                }\n            }\n        });\n        let ovr = calculateOVR(stats);\n        if (option === \"Min\") {\n            ovr = calculateOVR(minStats);\n        }\n        else if (option === \"Max\") {\n            ovr = calculateOVR(maxStats);\n        }\n        if (option !== \"Default\" || !scoutPlayer) {\n            updateOVR(ovr);\n        }\n    };\n    divs.forEach((div) => {\n        if (div.textContent && div.textContent.trim() === \"Skills\") {\n            const dropdown = document.createElement(\"select\");\n            dropdown.classList.add(\"stats-dropdown\");\n            dropdown.style.marginLeft = \"auto\";\n            dropdown.style.fontSize = \"12px\";\n            dropdown.style.padding = \"2px\";\n            dropdown.style.border = \"none\";\n            dropdown.style.backgroundColor = \"#fff\";\n            dropdown.style.color = \"#000\";\n            dropdown.style.width = \"85px\";\n            dropdown.style.height = \"18px\";\n            dropdown.style.lineHeight = \"18px\";\n            dropdown.style.paddingTop = \"0px\";\n            dropdown.style.paddingBottom = \"0px\";\n            dropdown.style.paddingRight = \"21px\";\n            dropdown.style.borderRadius = \"2px\";\n            dropdown.addEventListener(\"change\", (event) => {\n                const selectElement = event.target;\n                const selectedOption = selectElement.value;\n                updateHockeyPucks(selectedOption);\n            });\n            const options = [\"Default\", \"Min\", \"Max\"];\n            options.forEach((option) => {\n                const optionElement = document.createElement(\"option\");\n                optionElement.value = option;\n                optionElement.textContent = option;\n                optionElement.style.textAlign = \"center\";\n                dropdown.appendChild(optionElement);\n            });\n            div.appendChild(dropdown);\n        }\n    });\n    const statsRows = statsTable.querySelectorAll(\"tbody tr\");\n    if (!statsRows.length) {\n        return false;\n    }\n    const stats = {};\n    let scoutPlayer = false;\n    statsRows.forEach((row) => {\n        var _a, _b, _c, _d;\n        const statName = ((_b = (_a = row.cells[0]) === null || _a === void 0 ? void 0 : _a.textContent) === null || _b === void 0 ? void 0 : _b.trim()) || \"\";\n        const pucks = row.querySelectorAll(\"svg.fa-hockey-puck\");\n        const ratingText = (_d = (_c = row.cells[row.cells.length - 1]) === null || _c === void 0 ? void 0 : _c.textContent) === null || _d === void 0 ? void 0 : _d.trim();\n        const ratingMatch = ratingText ? ratingText.match(/\\((\\d+)\\)/) : null;\n        if (!scoutPlayer && !ratingMatch) {\n            scoutPlayer = true;\n        }\n        const rating = ratingMatch ? parseInt(ratingMatch[1], 10) : 0;\n        const hasRedPuck = Array.from(pucks).some((puck) => puck.classList.contains(\"max-level\"));\n        stats[statName] = {\n            rating,\n            hasRedPuck,\n            strength: null,\n        };\n    });\n    const talentContainer = document.querySelector(\"body\");\n    if (talentContainer) {\n        const talentText = talentContainer.textContent || \"\";\n        const strongestMatch = talentText.match(/Strongest talents of .+ are (\\w+ and \\w+)/);\n        const weakestMatch = talentText.match(/weakest talent is (\\w+)/);\n        const strongestTalents = strongestMatch\n            ? strongestMatch[1].split(\" and \")\n            : [];\n        const weakestTalent = weakestMatch ? weakestMatch[1] : \"\";\n        strongestTalents.forEach((talent) => {\n            if (stats[talent]) {\n                stats[talent].strength = \"strongest\";\n            }\n        });\n        if (weakestTalent && stats[weakestTalent]) {\n            stats[weakestTalent].strength = \"weakest\";\n        }\n    }\n    const minStats = JSON.parse(JSON.stringify(stats));\n    let weakestRating = 10;\n    let highestNonStrongestRating = 0;\n    // find the weakest rating\n    for (const key of Object.keys(minStats)) {\n        const stat = minStats[key];\n        if (stat.strength === \"weakest\") {\n            weakestRating = stat.rating;\n        }\n    }\n    // update ratings and find the highest non-strongest rating\n    for (const key of Object.keys(minStats)) {\n        const stat = minStats[key];\n        minStats[key].rating = stat.hasRedPuck ? stat.rating : stat.rating + 1;\n        if (stat.strength !== \"strongest\") {\n            highestNonStrongestRating = Math.max(highestNonStrongestRating, minStats[key].rating);\n        }\n    }\n    // adjust strongest stats\n    for (const key of Object.keys(minStats)) {\n        const stat = minStats[key];\n        if (stat.strength === \"strongest\" &&\n            stat.rating < highestNonStrongestRating) {\n            minStats[key].rating = highestNonStrongestRating;\n        }\n    }\n    // adjust weakest stats\n    for (const key of Object.keys(minStats)) {\n        if (minStats[key].rating < weakestRating) {\n            minStats[key].rating = weakestRating;\n        }\n        if (minStats[key].rating < 4) {\n            minStats[key].rating = 4;\n        }\n    }\n    const maxStats = JSON.parse(JSON.stringify(stats));\n    let strongestRating = 10;\n    let lowestNonWeakestRating = 10;\n    // find the strongest rating\n    for (const key of Object.keys(maxStats)) {\n        const stat = maxStats[key];\n        if (stat.strength === \"strongest\") {\n            strongestRating = Math.min(strongestRating, stat.hasRedPuck ? stat.rating : 10);\n        }\n    }\n    // update ratings and find the lowest non-weakest rating\n    for (const key of Object.keys(maxStats)) {\n        const stat = maxStats[key];\n        if (!stat.hasRedPuck && stat.rating < strongestRating) {\n            maxStats[key].rating = strongestRating;\n        }\n        if (stat.strength !== \"weakest\") {\n            lowestNonWeakestRating = Math.min(lowestNonWeakestRating, maxStats[key].rating);\n        }\n    }\n    // adjust strongest stats\n    for (const key of Object.keys(maxStats)) {\n        const stat = maxStats[key];\n        if (stat.strength === \"strongest\" && !stat.hasRedPuck && stat.rating < 10) {\n            maxStats[key].rating = 10;\n        }\n    }\n    // adjust weakest stats\n    for (const key of Object.keys(maxStats)) {\n        const stat = maxStats[key];\n        if (stat.strength === \"weakest\" && stat.rating > lowestNonWeakestRating) {\n            maxStats[key].rating = lowestNonWeakestRating;\n        }\n        if (maxStats[key].rating < 4) {\n            maxStats[key].rating = 4;\n        }\n    }\n    updateHockeyPucks(\"Default\");\n    return true;\n};\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    if (message.action === \"parseStatsTable\") {\n        if (!parseStatsTable()) {\n            const interval = setInterval(() => {\n                if (parseStatsTable()) {\n                    clearInterval(interval);\n                }\n            }, 100); // 0.1 Seconds\n            setTimeout(() => {\n                clearInterval(interval);\n            }, 10000); // 10 Seconds\n        }\n    }\n});\n"],"names":[],"sourceRoot":""}